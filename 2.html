<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>123</title>
    <link rel="stylesheet" href="s.css?123">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>

<body>


<table>
    <thead>
    <tr>
        <td>Наименование</td>
        <td>шт.</td>
        <td>THB</td>
        <td>Заказать</td>
    </tr>
    </thead>
    <tbody id="itemList">
    </tbody>
</table>

<p id="totalCost">Total Cost: 0</p>
<script>
    let tg = window.Telegram.WebApp;

    tg.expand();

    let items = [
        {name: "StarLine Экзотические Фрукты", quantity: 3, price: 350, incart: 0},
        {name: "StarLine Черничный Чизкейк", quantity: 12, price: 350, incart: 0},
        {name: "StarLine Экзотические Фрукты", quantity: 3, price: 350, incart: 0},
        {name: "StarLine Черничный Чизкейк", quantity: 12, price: 350, incart: 0},
        {name: "StarLine Экзотические Фрукты", quantity: 3, price: 350, incart: 0},
        {name: "StarLine Черничный Чизкейк", quantity: 12, price: 350, incart: 0},
    ];

    let totalCost = document.getElementById("totalCost");

    function calculateTotalCost() {
        let cost = 0;
        for (let i = 0; i < items.length; i++) {
            let item = items[i];
            cost += item.incart * item.price;
        }
        totalCost.innerHTML = `Total Cost: ${cost}`;
    }

    function updateIncart(index, value) {
        items[index].incart = Number(value);
        console.log(items)
        calculateTotalCost();
    }

    window.onload = function () {
        let itemList = document.getElementById("itemList");

        for (let i = 0; i < items.length; i++) {
            let item = items[i];
            let listItem = document.createElement("tr");
            listItem.innerHTML = `
                                <td>${item.name}</td>
                                <td>${item.quantity}</td>
                                <td>${item.price}</td>
                                <td>
                                <div class="number-input">
                                  <button onclick="this.parentNode.querySelector('input[type=number]').stepDown(); this.parentNode.querySelector('input[type=number]').dispatchEvent(new Event('change'))" ></button>
                                  <input class="quantity" name="quantity" type="number" min="0" max="${item.quantity}" value="${item.incart}" onchange="updateIncart(${i}, this.value)">
                                  <button onclick="this.parentNode.querySelector('input[type=number]').stepUp(); this.parentNode.querySelector('input[type=number]').dispatchEvent(new Event('change'))" class="plus"></button>
                                </div>
                                </td>
                              `;
            itemList.appendChild(listItem);
        }
    };
</script>
</body>
</html>
